C51 COMPILER V9.60.7.0   DHT11                                                             06/27/2025 11:39:28 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE DHT11
OBJECT MODULE PLACED IN ..\Output\dht11.obj
COMPILER INVOKED BY: D:\APP\Keil_v5\C51\BIN\C51.EXE ..\BSP\Src\dht11.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\BSP\Inc;
                    -..\Core\Inc;..\Driver;..\Emembed\Inc;..\SYSTEM\Inc) DEBUG OBJECTEXTEND PRINT(.\Listings\dht11.lst) OBJECT(..\Output\dht1
                    -1.obj)

line level    source

   1          #include  "dht11.h" 
   2          
   3          DHT11 dht11;
   4          
   5          /**
   6           * @brief       ‰ªéDHT11ËØªÂèñ‰∏Ä‰∏™Â≠óËäÇÔºåMSBÂÖàË°å
   7           *
   8           * @param   
   9           *
  10           * @return  ËØªÂèñÁöÑÂ≠óËäÇ
  11          **/
  12          static uint8_t Read_Byte(void)  
  13          {       
  14   1              uint8_t i, dat = 0;
  15   1      
  16   1              for( i = 0; i < 8; i++ )    
  17   1              {          
  18   2                      while(!Temp_Hum); //ÊØèbit‰ª•50us‰ΩéÁîµÂπ≥Ê†áÁΩÆÂºÄÂßãÔºåËΩÆËØ¢Áõ¥Âà∞‰ªéÊú∫ÂèëÂá∫ ÁöÑ50us ‰ΩéÁîµÂπ≥ ÁªìÊ
             -ùü
  19   2      
  20   2                      delay_us(40); //Âª∂Êó∂Á∫¶40us,Ëøô‰∏™Âª∂Êó∂ÈúÄË¶ÅÂ§ß‰∫éÊï∞ÊçÆ0ÊåÅÁª≠ÁöÑÊó∂Èó¥Âç≥ÂèØ                
  21   2      
  22   2              if(Temp_Hum)   //Á∫¶40usÂêé‰ªç‰∏∫È´òÁîµÂπ≥Ë°®Á§∫Êï∞ÊçÆ‚Äú1‚Äù
  23   2                      {
  24   3                              while(Temp_Hum);  //Á≠âÂæÖÊï∞ÊçÆ1ÁöÑÈ´òÁîµÂπ≥ÁªìÊùü
  25   3                              dat|=(uint8_t)(0x01<<(7-i));  //ÊääÁ¨¨7-i‰ΩçÁΩÆ1ÔºåMSBÂÖàË°å 
  26   3                      }
  27   2                      else     //40usÂêé‰∏∫‰ΩéÁîµÂπ≥Ë°®Á§∫Êï∞ÊçÆ‚Äú0‚Äù
  28   2                      {                          
  29   3                              dat&=(uint8_t)~(0x01<<(7-i)); //ÊääÁ¨¨7-i‰ΩçÁΩÆ0ÔºåMSBÂÖàË°å
  30   3                      }
  31   2              }
  32   1              return dat;     
  33   1      }
  34          
  35          /**
  36           * @brief       DHT11ËØªÂèñÂºÄÂßã Êó∂Â∫èÂèòÂåñ
  37           *
  38           * @param   
  39           *
  40           * @return  ËØªÂèñÁöÑÂ≠óËäÇ
  41          **/
  42          void DHT11_start()
  43          {
  44   1          Temp_Hum = 1;
  45   1          delay_us(2);
  46   1      
  47   1          Temp_Hum = 0;
  48   1          delay_ms(30);   //Êãâ‰ΩéÂª∂Êó∂18ms‰ª•‰∏ä
  49   1      
  50   1          Temp_Hum = 1;
  51   1          delay_us(30);   //ÊãâÈ´ò Âª∂Êó∂ 20~40usÔºåÂèñ‰∏≠Èó¥ÂÄº 30us
  52   1      }
C51 COMPILER V9.60.7.0   DHT11                                                             06/27/2025 11:39:28 PAGE 2   

  53          
  54          /**
  55           * @brief       ËØªÂèñÊ∏©ÊπøÂ∫¶
  56           *
  57           * @param   
  58           *
  59           * @return  ËØªÂèñÁöÑÂ≠óËäÇ
  60          **/
  61          void Read_DHT11(void)       
  62          {
  63   1          uint8_t R_H,R_L,T_H,T_L,revise; 
  64   1      
  65   1          DHT11_start();
  66   1              
  67   1          /* 1, Âà§Êñ≠‰ªéÊú∫ÊòØÂê¶Êúâ‰ΩéÁîµÂπ≥ÂìçÂ∫î‰ø°Âè∑ Â¶Ç‰∏çÂìçÂ∫îÂàôË∑≥Âá∫ÔºåÂìçÂ∫îÂàôÂêë‰∏ãËøêË°å   */
  68   1          if(!Temp_Hum)      
  69   1          {
  70   2              /* 2, ËΩÆËØ¢Áõ¥Âà∞‰ªéÊú∫ÂèëÂá∫ÁöÑ83us ‰ΩéÁîµÂπ≥ ÂìçÂ∫î‰ø°Âè∑ÁªìÊùü   */
  71   2              while(!Temp_Hum);  
  72   2      
  73   2              /* 3, ËΩÆËØ¢Áõ¥Âà∞‰ªéÊú∫ÂèëÂá∫ÁöÑ87us È´òÁîµÂπ≥ Ê†áÁΩÆ‰ø°Âè∑ÁªìÊùü   */
  74   2              while(Temp_Hum);    
  75   2                              
  76   2                      /* 4, ÂºÄÂßãÊé•Êî∂Êï∞ÊçÆ                                */       
  77   2              R_H= Read_Byte();
  78   2              R_L= Read_Byte();
  79   2              T_H= Read_Byte();
  80   2              T_L= Read_Byte();
  81   2      
  82   2              revise = Read_Byte();
  83   2      
  84   2              /* 5, ËØªÂèñÁªìÊùüÔºå‰∏ªÊú∫ÊãâÈ´ò                          */    
  85   2              Temp_Hum =1 ;                   
  86   2      
  87   2              /* 6, ÊúÄÂêé‰∏ÄÂ≠óËäÇ‰∏∫Ê†°È™å‰ΩçÔºåÊ†°È™åÊòØÂê¶Ê≠£Á°Æ            */
  88   2              if( (R_H+R_L+T_H+T_L) == revise )      //
  89   2              {
  90   3                  /* 7, Ê†°È™åÊ≠£Á°ÆÔºå‰∏∫ÁªìÊûÑ‰ΩìËµãÂÄº                  */
  91   3                  dht11.dht11_temp  = T_H;
  92   3                  dht11.dht11_humidity = R_H;
  93   3              }
  94   2          } 
  95   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    229    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      3       6
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
